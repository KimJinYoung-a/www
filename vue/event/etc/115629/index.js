var app = new Vue({
    el: '#app'
    , template: `
        <div class="evt115629">
            <div class="topic txt-hidden">Happy 2022 Wake Up</div>
            <div class="section prd01">
                <div class="w1140">
                    <a href="/shopping/category_prd.asp?itemid=3073479&pEtr=115629" class="item01 item3073479">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=3825689&pEtr=115629" class="item02 item3825689">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=1736999&pEtr=115629" class="item03 item1736999">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                </div>
            </div>
            <div class="section prd02">
                <div class="w1140">
                    <a href="/shopping/category_prd.asp?itemid=3086753&pEtr=115629" class="item01 item3086753">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=4096410&pEtr=115629" class="item02 item4096410">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=1791832&pEtr=115629" class="item03 item1791832">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=2512939&pEtr=115629" class="item04 item2512939">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=2917687&pEtr=115629" class="item05 item2917687">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                </div>
            </div>
            <div class="section prd03">
                <div class="w1140">
                    <a href="/shopping/category_prd.asp?itemid=2864759&pEtr=115629" class="item01 item2864759">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=2607302&pEtr=115629" class="item02 item2607302">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=4029268&pEtr=115629" class="item03 item4029268">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=4126636&pEtr=115629" class="item04 item4126636">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=4200402&pEtr=115629" class="item05 item4200402">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                </div>
            </div>
            <div class="section prd04">
                <div class="w1140">
                    <a href="/shopping/category_prd.asp?itemid=3020550&pEtr=115629" class="item01 item3020550">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=3887618&pEtr=115629" class="item02 item3887618">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                    <a href="/shopping/category_prd.asp?itemid=2140267&pEtr=115629" class="item03 item2140267">
                        <div class="desc">
                            <span class="wish"><span class="icon"></span><span class="counting">999+</span></span>
                        </div>
                    </a>
                </div>
            </div>
            <div class="prd05">
                <div class="w1140">
                    <a href="/shopping/category_prd.asp?itemid=4242172&pEtr=115629" class="item01">캐시미아 머플러</a>
                    <a href="/shopping/category_prd.asp?itemid=4304474&pEtr=115629" class="item02">kapka</a>
                    <a href="/shopping/category_prd.asp?itemid=2565696&pEtr=115629" class="item03">마크모크 워커</a>
                    <a href="/shopping/category_prd.asp?itemid=3504305&pEtr=115629" class="item04">샌드위치메이커</a>
                    <a href="/shopping/category_prd.asp?itemid=3398483&pEtr=115629" class="item05">판도라</a>
                    <a href="/shopping/category_prd.asp?itemid=4316834&pEtr=115629" class="item06">케어베어</a>
                    <a href="/shopping/category_prd.asp?itemid=2453471&pEtr=115629" class="item07">로지텍</a>
                    <a href="/shopping/category_prd.asp?itemid=4318375&pEtr=115629" class="item08">아르르</a>
                    <a href="/shopping/category_prd.asp?itemid=3938243&pEtr=115629" class="item09">홈즈</a>
                    <a href="/shopping/category_prd.asp?itemid=3095413&pEtr=115629" class="item10">폭신폭신</a>
                    <a href="/shopping/category_prd.asp?itemid=4051527&pEtr=115629" class="item11">신라오</a>
                    <a href="/shopping/category_prd.asp?itemid=4337174&pEtr=115629" class="item12">에뛰드</a>
                    <a href="/shopping/category_prd.asp?itemid=3950903&pEtr=115629" class="item13">마그넷</a>
                    <a href="/shopping/category_prd.asp?itemid=3947421&pEtr=115629" class="item14">스누피 하우스 러그</a>
                    <a href="/shopping/category_prd.asp?itemid=3947424&pEtr=115629" class="item15">스누피 러그</a>
                </div>
            </div>
            <div class="co-area">
                <div class="w1140">
                    <img src="http://webimage.10x10.co.kr/fixevent/event/2021/115629/top_comment.jpg" alt="comment event 텐바이텐 1만원 키프트권을 드립니다.">
                    <div class="co-input">
                        <textarea v-model="comment_text" @input="change_comment_text" id="input-letter" rows="1" placeholder="이 곳에 소원을 남기면 모두 이루어질거에요! 수리수리 마수리!"></textarea>
                    </div>
                    <button @click="go_comment_reg" type="submit"><img src="http://webimage.10x10.co.kr/fixevent/event/2021/115629/btn_comment.png" alt="작성 및 응모하기"></button>
                </div>
            </div>
        </div>
    `
    , mounted(){
        $("#input-letter").on("propertychange change keyup paste input",function(){
            $(this)[0].style.height='auto';
            $(this).height( $(this).prop('scrollHeight'));
        });
        fnApplyToTalPriceItem({
            items:"3073479,3825689,1736999,3086753,4096410,1791832,2512939,2917687,2864759,2607302,4029268,4126636,4200402,3020550,3887618,2140267",
            target:"item",
            fields:["wish"]
        });
    }
    , data() {
        return {
            evt_code : 115629
            , comment_text : ""
            , ing_reg : false
        }
    }
    , methods : {
        go_comment_reg(){
            const _this = this;

            if(isUserLoginOK) {
                call_api("GET", "/tempEvent/user-comment-count", {"event_code" : _this.evt_code}, function (data) {
                    if(data >= 3){
                        alert("최대 3회까지까지 참여가 가능합니다.");
                        return false;
                    }else{
                        if(_this.comment_text.trim().length == 0){
                            alert("내용을 입력해주세요.");
                            return false
                        }
                        if (_this.ing_reg) {
                            return false;
                        }

                        _this.ing_reg = true;
                        let api_data = {
                            "event_code": _this.evt_code
                            , "evtcom_txt": _this.comment_text
                        };
                        call_api("POST", "/tempEvent/comment", api_data, function (data) {
                            alert("응모가 완료되었습니다. \n소원은 모바일과 텐바이텐 앱에서 확인 가능합니다.");

                            _this.comment_text = "";
                            _this.ing_reg = false;
                        });
                    }
                });
            }else{
                alert("이벤트에 응모를 하려면 로그인이 필요합니다.");
            }
        }
        , change_comment_text(e){
            if(e.target.value.length > 18){
                this.comment_text = this.comment_text.substr(0,18);
                alert("최대 18자까지 입력가능합니다.");
            }
        }
    }
});